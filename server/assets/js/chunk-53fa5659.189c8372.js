(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53fa5659"],{"39d1":function(t,o,e){"use strict";var s=e("2638"),a=e.n(s),n=e("a142"),i=e("ba31"),c=e("db78"),r=e("ad06"),l=Object(n["i"])("rate"),d=l[0],m=l[1];function u(t,o,e){return t>=o?"full":t+.5>=o&&e?"half":"void"}function f(t,o,e,s){for(var n=o.icon,l=o.size,d=o.color,f=o.voidIcon,v=o.readonly,C=o.disabled,g=o.voidColor,p=o.disabledColor,b=[],h=1;h<=o.count;h++)b.push(u(o.value,h,o.allowHalf));function S(t){C||v||(Object(i["a"])(s,"input",t),Object(i["a"])(s,"change",t))}function I(t){if(!v&&!C&&document.elementFromPoint){Object(c["c"])(t);var o=t.touches[0],e=o.clientX,s=o.clientY,a=document.elementFromPoint(e,s);if(a&&a.dataset){var n=a.dataset.score;n&&S(+n)}}}function y(e,s){var a="full"===e,i="void"===e;return t("div",{key:s,class:m("item")},[t(r["a"],{attrs:{name:a?n:f,size:l+"px","data-score":s+1,color:C?p:a?d:g},class:m("icon"),on:{click:function(){S(s+1)}}}),o.allowHalf&&t(r["a"],{attrs:{name:i?f:n,size:l+"px","data-score":s+.5,color:C?p:i?g:d},class:m("icon","half"),on:{click:function(){S(s+.5)}}})])}return t("div",a()([{class:m()},Object(i["b"])(s),{on:{touchmove:I}}]),[b.map(function(t,o){return y(t,o)})])}f.props={value:Number,readonly:Boolean,disabled:Boolean,allowHalf:Boolean,size:{type:Number,default:20},icon:{type:String,default:"star"},voidIcon:{type:String,default:"star-o"},color:{type:String,default:"#ffd21e"},voidColor:{type:String,default:"#c7c7c7"},disabledColor:{type:String,default:"#bdbdbd"},count:{type:Number,default:5}},o["a"]=d(f)},4142:function(t,o,e){"use strict";e("68ef"),e("8199")},4778:function(t,o,e){},"69cb":function(t,o,e){"use strict";e.r(o);var s=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",{staticClass:"evaluate"},[t._l(t.goodsList,function(o,a){return s("div",{key:a,staticClass:"main"},[s("div",{staticClass:"main-box"},[s("div",{staticClass:"product van-clearfix"},[s("div",{staticClass:"img"},[s("img",{attrs:{src:t.getImg(o.thumb,"150*150"),onerror:"errImg(event)"}}),s("img",{directives:[{name:"show",rawName:"v-show",value:1==o.orderFlag,expression:"item.orderFlag==1"}],staticClass:"customization",attrs:{src:e("a2b3")}})]),s("div",{staticClass:"desc"},[s("p",{staticClass:"name"},[t._v(t._s(o.goodsName))]),s("p",{staticClass:"color"},[t._v(t._s(o.colorName)+" /"+t._s(o.sizeName))])])]),s("div",{staticClass:"rate"},[s("div",{staticClass:"item van-clearfix"},[s("div",{staticClass:"title"},[t._v("评分")]),s("div",{staticClass:"star"},[s("van-rate",{attrs:{size:20,count:5,color:"#2ba4f3","void-color":"#ccc"},model:{value:o.commentScore,callback:function(e){t.$set(o,"commentScore",e)},expression:"item.commentScore"}})],1),s("div",{staticClass:"tip"},[t._v(t._s(t.commentScoreDesc[o.commentScore]))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:1==o.orderFlag,expression:"item.orderFlag==1"}],staticClass:"item van-clearfix"},[s("div",{staticClass:"title"},[t._v("着装师评价")]),s("div",{staticClass:"star"},[s("van-rate",{attrs:{size:20,count:5,color:"#2ba4f3","void-color":"#ccc"},model:{value:o.msrCommentScore,callback:function(e){t.$set(o,"msrCommentScore",e)},expression:"item.msrCommentScore"}})],1),s("div",{staticClass:"tip"},[t._v(t._s(t.msrCommentScoreDesc[o.msrCommentScore]))])])]),s("div",{staticClass:"content"},[s("div",{staticClass:"description"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:o.reasonMemo,expression:"item.reasonMemo"}],attrs:{cols:"100",rows:"1",placeholder:"点击输入评价内容",maxlength:"150"},domProps:{value:o.reasonMemo},on:{input:function(e){e.target.composing||t.$set(o,"reasonMemo",e.target.value)}}})])]),s("upload-file",{model:{value:t.goodsList[a].commentPictList,callback:function(o){t.$set(t.goodsList[a],"commentPictList",o)},expression:"goodsList[index].commentPictList"}})],1),s("div",{staticClass:"gray"})])}),s("debounce",{attrs:{time:1e3,events:"click"}},[t.goodsList.length>0?s("button",{on:{click:t.submitEvaluate}},[t._v("提交")]):t._e()])],2)},a=[],n=(e("ac6a"),e("e7e5"),e("d399")),i=(e("4142"),e("39d1")),c=e("2b61"),r=e("22ce"),l=e("c46c"),d={name:"order-evaluate",data:function(){return{goodsList:[],commentScoreDesc:["","不合体","不合体","基本合体","合体","非常合体"],msrCommentScoreDesc:["","不满意","不满意","一般","满意","非常满意"]}},components:{"van-rate":i["a"],uploadFile:l["a"]},methods:{getGoodsInfo:function(){var t=this,o=c["a"].get("COMPANYID").company_id,e={busContsCode:baseConstant.busContsCode,usrId:"",companyId:o,ownCompanyId:o,billCode:this.$route.query.billCode};r["g"].getDetailInfo(e).then(function(o){t.goodsList=t.getGoodsList(o.data.packages)})},submitEvaluate:function(){var t=this,o={billCode:this.$route.query.billCode,busContsCode:baseConstant.busContsCode};r["g"].getDetailInfo(o).then(function(o){if(1===o.allowCommentFlag)return t.$toast("该订单已存在评价"),!1;var e=c["a"].get("COMPANYID").company_id,s=c["a"].get("USER_INFO"),a={companyId:e,usrId:s.usrId,model:{anonymousFlag:0,billCode:t.$route.query.billCode,buscontsCode:baseConstant.busContsCode,shopCode:c["a"].get("properties").shopCode,usrId:s.usrId,vipInfoHdId:s.vipInfoId}},i=t.getEvaluate();i.msg?Object(n["a"])(i.msg):(a.model.goodsCommentList=i.goodsCommentList,r["g"].ordComment(a).then(function(o){console.log("评价完成",o),"/orderList"===t.fromPath?t.$router.go(-1):t.$router.go(-2)}))})},getEvaluate:function(){var t=[],o=null;return this.goodsList.forEach(function(e,s){t.push({commentMemo:e.reasonMemo,commentScore:e.commentScore,commentTypeCode:"D_MASPART",goodsCode:e.goodsCode,rtlOrdDtId:e.saleOrdDtId,commentPictList:e.commentPictList}),o=e.commentScore||o?o:"商品评分是必填项哦~",1==e.orderFlag&&(o=e.msrCommentScore||o?o:"量体师评分是必填项哦~",t[s].msrCommentScore=e.msrCommentScore)}),{msg:o,goodsCommentList:t}},setStorage:function(){c["a"].set("ordInfo",this.$route.params)},getGoodsList:function(t){var o=[];return t.forEach(function(t){o=o.concat(t.data.goodsList)}),o}},beforeRouteEnter:function(t,o,e){e(function(t){t.fromPath=o.path})},created:function(){this.setStorage()},mounted:function(){this.getGoodsInfo()}},m=d,u=(e("f7cd"),e("2877")),f=Object(u["a"])(m,s,a,!1,null,"f0a72de2",null);o["default"]=f.exports},8199:function(t,o,e){},a2b3:function(t,o,e){t.exports=e.p+"img/diy.181a3673.png"},f7cd:function(t,o,e){"use strict";var s=e("4778"),a=e.n(s);a.a}}]);