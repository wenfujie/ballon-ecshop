(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-203d0120"],{"1da0":function(t,e,a){},"41e7":function(t,e,a){"use strict";var n=a("1da0"),o=a.n(n);o.a},"8a58":function(t,e,a){"use strict";a("68ef"),a("4d75")},e41f:function(t,e,a){"use strict";var n=a("a142"),o=a("6605"),c=Object(n["i"])("popup"),i=c[0],s=c[1];e["a"]=i({mixins:[o["a"]],props:{position:String,transition:String,overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}},render:function(t){var e,a=this;if(this.shouldRender){var n=this.position,o=function(t){return function(){return a.$emit(t)}},c=this.transition||(n?"van-popup-slide-"+n:"van-fade");return t("transition",{attrs:{name:c},on:{afterEnter:o("opened"),afterLeave:o("closed")}},[t("div",{directives:[{name:"show",value:this.value}],class:s((e={},e[n]=n,e))},[this.slots()])])}}})},e595:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bind-wrapper"},[t._m(0),1==t.step?a("div",{staticClass:"form-wrapper"},[a("p",{staticClass:"form-text"},[t._v("原手机号")]),a("div",{staticClass:"form-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNum,expression:"phoneNum"}],staticClass:"phone-text",attrs:{placeholder:"请输入原手机号",type:"tel",maxlength:"11"},domProps:{value:t.phoneNum},on:{input:function(e){e.target.composing||(t.phoneNum=e.target.value)}}})]),a("p",{staticClass:"form-text"},[t._v("验证码")]),a("div",{staticClass:"form-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.captcha,expression:"captcha"}],staticClass:"captcha-text",attrs:{placeholder:"请输入短信验证码",type:"tel",maxlength:"6"},domProps:{value:t.captcha},on:{input:function(e){e.target.composing||(t.captcha=e.target.value)}}}),a("button",{staticClass:"captcha-btn",class:[1==t.captchaLocked?"disabled":""],on:{click:t.checkPhone}},[t._v(t._s(t.captchaText))])]),a("div",{staticClass:"bind-btn",on:{click:function(e){t.nextStep()}}},[t._v("下一步")])]):t._e(),2==t.step?a("div",{staticClass:"form-wrapper"},[a("p",{staticClass:"form-text"},[t._v("新手机号")]),a("div",{staticClass:"form-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNum,expression:"phoneNum"}],staticClass:"phone-text",attrs:{placeholder:"请输入新手机号",type:"tel",maxlength:"11"},domProps:{value:t.phoneNum},on:{input:function(e){e.target.composing||(t.phoneNum=e.target.value)}}})]),a("p",{staticClass:"form-text"},[t._v("验证码")]),a("div",{staticClass:"form-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.captcha,expression:"captcha"}],staticClass:"captcha-text",attrs:{placeholder:"请输入验证码",type:"tel",maxlength:"6"},domProps:{value:t.captcha},on:{input:function(e){e.target.composing||(t.captcha=e.target.value)}}}),a("button",{staticClass:"captcha-btn",class:[1==t.captchaLocked?"disabled":""],on:{click:t.checkPhone}},[t._v(t._s(t.captchaText))])]),a("div",{staticClass:"bind-btn",on:{click:t.bindNewPhone}},[t._v("确定")])]):t._e()])},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"close-btn",attrs:{onclick:"window.history.go(-1)"}},[a("i",{staticClass:"iconfont icon-guanbi"})])}],c=(a("e7e5"),a("d399")),i=(a("8a58"),a("e41f")),s=a("2b61"),h=a("22ce"),r={components:{"van-popup":i["a"]},data:function(){return{phoneNum:"",captcha:"",countDownData:void 0,captchaText:"获取验证码",captchaLocked:!1,time:60,ctmUsrKey:"",companyKey:"",cookieKey:"",step:1,oldPhone:"",newPhone:"",btnLock:"",userInfo:{}}},methods:{getUser:function(){var t=this,e={};h["k"].getUserInfo(e).then(function(e){t.userInfo=e})},checkPhone:function(){var t=this;if(!0!==this.captchaLocked)if(1===this.step){if(this.phoneNum!==this.userInfo.mobilePhone)return void Object(c["a"])("该手机号不是原手机号~");this.getcaptcha()}else{var e={id:s["a"].get("USER_INFO").usrId,mobile:this.phoneNum,ownCompanyId:s["a"].get("COMPANYID").company_id};h["k"].checkPhone(e).then(function(e){t.getcaptcha()},function(t){Object(c["a"])(t.errorMsg)})}},getcaptcha:function(){var t=/^1(((5[0-35-9][0-9])|(7([0678])[ 0-9])|([3489][0-9]{2}))[0-9]{7})$/,e=this.phoneNum;if(t.test(e)){var a={id:s["a"].get("USER_INFO").usrId,mobile:e,verifyClassCode:"VERIFY_CHANGE_MOBILE"};h["k"].getCaptcha(a).then(function(t){},function(t){}),this.conutDown()}else Object(c["a"])("请填写正确的手机号")},conutDown:function(){var t=this;this.captchaLocked=!0,this.captchaText="验证码已发送",this.countDownData=window.setInterval(function(){t.captchaText="重新获取"+t.time+"s",t.time--<=0&&(t.time=60,t.captchaLocked=!1,t.captchaText="获取验证码",window.clearInterval(t.countDownData))},1e3)},nextStep:function(){var t=this;if(console.log("??"),this.phoneNum)if(this.captcha)if(this.phoneNum===this.userInfo.mobilePhone){var e={mobilePhone:this.phoneNum,registCode:this.captcha,verifyClassCode:"VERIFY_CHANGE_MOBILE"};h["k"].checkCaptcha(e).then(function(e){t.oldPhone=t.phoneNum,t.phoneNum="",t.captcha="",window.clearInterval(t.countDownData),t.captchaText="获取验证码",t.captchaLocked=!1,t.time=60,t.step=2},function(t){Object(c["a"])("验证码错误，请重新输入！")})}else Object(c["a"])("该手机号不是原手机号~");else Object(c["a"])("请先输入验证码~");else Object(c["a"])("请先输入手机号~")},bindNewPhone:function(){var t=this;if(!0!==this.btnLock){this.btnLock=!0;var e=/^1(((5[0-35-9][0-9])|(7([0678])[ 0-9])|([3489][0-9]{2}))[0-9]{7})$/;if(!e.test(this.phoneNum))return Object(c["a"])("请先输入正确的手机号"),void(this.btnLock=!1);if(!this.captcha)return Object(c["a"])("请先输入验证码"),void(this.btnLock=!1);var a={mobilePhone:this.phoneNum,registCode:this.captcha,verifyClassCode:"VERIFY_CHANGE_MOBILE"};h["k"].checkCaptcha(a).then(function(e){var a={newMobile:t.phoneNum,oldMobile:t.oldPhone};h["k"].changePhone(a).then(function(e){if(e.errorCode)Object(c["a"])(e.errorMsg);else{Object(c["a"])("更换绑定成功~");var a=s["a"].get("USER_INFO");a.mobilePhone=t.phoneNum,s["a"].set("USER_INFO",a),window.history.go(-1)}},function(t){Object(c["a"])(t.errorMsg)}).then(function(){t.btnLock=!1})},function(e){Object(c["a"])("验证码错误，请重新输入~"),t.btnLock=!1}).then(function(){t.btnLock=!1})}}},created:function(){this.getUser()}},p=r,l=(a("41e7"),a("2877")),u=Object(l["a"])(p,n,o,!1,null,"7b5899b4",null);e["default"]=u.exports}}]);