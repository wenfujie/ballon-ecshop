(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41942e6e"],{2381:function(e,t,i){},"404e":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"member-information"},[i("div",{staticClass:"van-cell user-img-cell"},[i("div",{staticClass:"van-cell__title"},[e._v("头像")]),i("van-uploader",{staticClass:"user-img",attrs:{"before-read":e.beforeRead,multiple:"","after-read":e.afterRead}},[i("div",{staticClass:"user-img"},[i("img",{attrs:{src:e._f("imageFilter")(e.userInfo.photoThumb),onerror:"errImg(event)",alt:""}})])]),i("i",{staticClass:"iconfont icon-youfan"})],1),i("van-field",{attrs:{label:"姓名",placeholder:"请输入昵称",max:"",required:""},on:{"click-icon":function(t){e.username=""}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),i("van-field",{attrs:{label:"性别",placeholder:"请选择性别",readonly:"",icon:"arrow",required:""},on:{focus:function(t){e.onShowpicker("sexPickerShow")}},model:{value:e.usersex,callback:function(t){e.usersex=t},expression:"usersex"}}),i("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号",disabled:"",required:""},model:{value:e.userphone,callback:function(t){e.userphone=t},expression:"userphone"}},[i("a",{attrs:{slot:"button"},on:{click:function(t){e.changePhone()}},slot:"button"},[e._v("更换手机号")])]),i("van-field",{attrs:{label:"电子邮箱",placeholder:"请输入电子邮箱"},on:{"click-icon":function(t){e.userEmail=""}},model:{value:e.userEmail,callback:function(t){e.userEmail=t},expression:"userEmail"}}),i("van-field",{attrs:{label:"生日",placeholder:"请选择出生日期",readonly:"",arrow:"",icon:"arrow"},on:{focus:function(t){e.onShowpicker("birthdayPickerShow")}},model:{value:e.userbirthday,callback:function(t){e.userbirthday=t},expression:"userbirthday"}}),i("van-picker",{directives:[{name:"show",rawName:"v-show",value:e.sexPickerShow,expression:"sexPickerShow"}],ref:"sexPicker",staticClass:"picker-fixed",attrs:{columns:e.columns,"show-toolbar":""},on:{change:e.onSexChange,cancel:function(t){e.onCancel("sexPickerShow")},confirm:e.onSexConfirm}}),i("van-datetime-picker",{directives:[{name:"show",rawName:"v-show",value:e.birthdayPickerShow,expression:"birthdayPickerShow"}],staticClass:"picker-fixed",attrs:{type:"date",maxDate:e.maxDate,"min-date":e.minDate},on:{change:e.onBirthday,cancel:function(t){e.onCancel("birthdayPickerShow")},confirm:e.onBirthdayConfirm},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}}),i("div",{staticClass:"common-bottom-btn",on:{click:e.putUserInfo}},[i("p",{staticClass:"btn-txt"},[e._v("提交")])]),e.sexPickerShow||e.birthdayPickerShow?i("div",{staticClass:"masks"}):e._e(),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showMemberSelect,callback:function(t){e.showMemberSelect=t},expression:"showMemberSelect"}},[i("van-picker",{staticClass:"picker-fixed",attrs:{columns:e.changeMemberInfo,"show-toolbar":""},on:{cancel:e.cancelMemberInfo,confirm:e.changeMember}})],1)],1)},n=[],s=(i("c5f6"),i("a481"),i("ac6a"),i("e7e5"),i("d399")),o=(i("28a5"),i("e930"),i("8f80")),r=(i("68ef"),i("2381"),i("a142")),c=i("ad06"),u={data:function(){return{parent:null}},methods:{findParent:function(e){var t=this.$parent;while(t){if(t.$options.name===e){this.parent=t;break}t=t.$parent}}}},l=function(e,t){return{mixins:[u],props:{name:null,value:null,disabled:Boolean,checkedColor:String,labelPosition:String,labelDisabled:Boolean,shape:{type:String,default:"round"}},created:function(){this.findParent(e)},computed:{isDisabled:function(){return this.parent&&this.parent.disabled||this.disabled},iconStyle:function(){var e=this.checkedColor;if(e&&this.checked&&!this.isDisabled)return{borderColor:e,backgroundColor:e}}},render:function(e){var i=this,a=this.slots,n=this.checked,s=a("icon",{checked:n})||e(c["a"],{attrs:{name:"success"},style:this.iconStyle}),o=a()&&e("span",{class:t("label",[this.labelPosition,{disabled:this.isDisabled}]),on:{click:this.onClickLabel}},[a()]);return e("div",{class:t(),on:{click:function(e){i.$emit("click",e)}}},[e("div",{class:t("icon",[this.shape,{disabled:this.isDisabled,checked:n}]),on:{click:this.onClickIcon}},[s]),o])}}},h=Object(r["i"])("checkbox"),m=h[0],d=h[1],f=m({mixins:[l("van-checkbox-group",d)],computed:{checked:{get:function(){return this.parent?-1!==this.parent.value.indexOf(this.name):this.value},set:function(e){this.parent?this.setParentValue(e):this.$emit("input",e)}}},watch:{value:function(e){this.$emit("change",e)}},methods:{toggle:function(){var e=this,t=!this.checked;clearTimeout(this.toggleTask),this.toggleTask=setTimeout(function(){e.checked=t})},onClickIcon:function(){this.isDisabled||this.toggle()},onClickLabel:function(){this.isDisabled||this.labelDisabled||this.toggle()},setParentValue:function(e){var t=this.parent,i=t.value.slice();if(e){if(t.max&&i.length>=t.max)return;-1===i.indexOf(this.name)&&(i.push(this.name),t.$emit("input",i))}else{var a=i.indexOf(this.name);-1!==a&&(i.splice(a,1),t.$emit("input",i))}}}}),b=Object(r["i"])("checkbox-group"),p=b[0],v=b[1],g=p({props:{max:Number,value:Array,disabled:Boolean},watch:{value:function(e){this.$emit("change",e)}},render:function(e){return e("div",{class:v()},[this.slots()])}}),k=(i("dde9"),Object(r["i"])("radio")),x=k[0],C=k[1],w=x({mixins:[l("van-radio-group",C)],computed:{currentValue:{get:function(){return this.parent?this.parent.value:this.value},set:function(e){(this.parent||this).$emit("input",e)}},checked:function(){return this.currentValue===this.name}},methods:{onClickIcon:function(){this.isDisabled||(this.currentValue=this.name)},onClickLabel:function(){this.isDisabled||this.labelDisabled||(this.currentValue=this.name)}}}),y=Object(r["i"])("radio-group"),S=y[0],I=y[1],V=S({props:{value:null,disabled:Boolean},watch:{value:function(e){this.$emit("change",e)}},render:function(e){return e("div",{class:I()},[this.slots()])}}),D=(i("8a58"),i("e41f")),P=(i("d1cf"),i("ee83")),T=(i("5f5f"),i("f253")),A=(i("c3a6"),i("be7f"),i("565f")),N=i("22ce"),E=(i("2b61"),{name:"member-information",components:{"van-field":A["a"],"van-icon":c["a"],"van-picker":T["a"],"van-datetime-picker":P["a"],"van-popup":D["a"],"van-radio-group":V,"van-radio":w,"van-checkbox-group":g,"van-checkbox":f,"van-uploader":o["a"]},data:function(){return{username:"",userEmail:"",columns:[{text:"男",value:"D_MALE"},{text:"女",value:"D_FEMALE"}],sexPickerShow:!1,birthdayPickerShow:!1,usersex:"",userSexCode:"",userphone:"",userbirthday:"",currentDate:new Date(1985,0,1),maxDate:new Date,minDate:new Date(1900,1,1),userheight:"",userweight:"",userwaist:"",userInfo:{},memberInfo:[],showMemberSelect:!1,memberType:"",changeMemberInfo:[],scrollTop:0,btnLock:!1}},methods:{onShowpicker:function(e){this[e]=!0},onCancel:function(e){this[e]=!1},onSexChange:function(e,t,i){this.sexName=t},onSexConfirm:function(){this.sexName||(this.sexName=this.columns[0]),this.usersex=this.sexName.text,this.userSexCode=this.sexName.value,this.sexPickerShow=!1},onBirthday:function(e,t,i){this.birthday=e.getValues()},onBirthdayConfirm:function(){this.birthday||(this.birthday=[this.currentDate.getFullYear(),("0"+parseInt(this.currentDate.getMonth()+1)).slice(-2),("0"+this.currentDate.getDate()).slice(-2)]),this.userbirthday=this.birthday[0]+"-"+this.birthday[1]+"-"+this.birthday[2],this.onCancel("birthdayPickerShow")},changePhone:function(){this.$router.push("/phone-change")},getUserInfo:function(){var e=this,t={};N["k"].getUserInfo(t).then(function(t){e.userInfo=t,e.username=t.vipAccount?t.vipAccount:"",e.userEmail=t.email?t.email:"",e.photoId=t.photoId?t.photoId:"",t.sexCode&&t.sexName&&(e.userSexCode=t.sexCode,e.usersex=t.sexName),e.userbirthday=t.solarcalendar?t.solarcalendar.split(" ")[0]:null,e.userphone=t.mobilePhone;for(var i=0,a=0;a<e.columns.length;a++)if(e.columns[a].text==e.usersex){i=a;break}e.$refs.sexPicker.setColumnIndex(0,i),e.userbirthday&&(e.currentDate=new Date(e.userbirthday))})},beforeRead:function(e){if("image/png"==e.type||"image/jpeg"==e.type||"image/jpg"==e.type||"image/bmp"==e.type){var t=e.size/1024/1024<4;return!!t||(Object(s["a"])("图片过大，请更换一张或者进行压缩后上传"),!1)}return Object(s["a"])("上传图片必须是 JPG/PNG 格式!"),!1},afterRead:function(e){var t=this;uploadImg(e.file).then(function(i){t.photoId=i,console.log(e),console.log(e.content),t.userInfo.photoThumb=e.content})},putUserInfo:function(){var e=this;if(!this.btnLock)if(this.username)if(this.username.length>10)Object(s["a"])("昵称只能输入1-10个字符~");else{var t=/^\S*$/;if(t.test(this.username)){if(this.userEmail){var i=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/i;if(!i.test(this.userEmail))return void Object(s["a"])("邮箱格式不正确~")}this.btnLock=!0;for(var a={},n=[],o=0;o<this.memberInfo.length;o++){var r=this.memberInfo[o];if(1===r.showFlag)if(1===r.mustFlag)if("D_MULTISELECT"===r.unfontClassCode&&"D_ALISTOF"===r.selectClassCode){if(!(r.customValueArr.length>0))return Object(s["a"])(r.customName+"为必填内容~"),this.btnLock=!1,!1;for(var c=0;c<r.customValueArr.length;c++)a.customCode=r.customCode,a.customValue=r.customValueArr[c],n.push(a),a={}}else{if(!r.customCode||!r.customValue)return Object(s["a"])(r.customName+"为必填内容~"),this.btnLock=!1,!1;a.customCode=r.customCode,a.customValue=r.customValue,n.push(a),a={}}else if("D_MULTISELECT"===r.unfontClassCode&&"D_ALISTOF"===r.selectClassCode){if(r.customValueArr.length>0)for(var u=0;u<r.customValueArr.length;u++)a.customCode=r.customCode,a.customValue=r.customValueArr[u],n.push(a),a={}}else a.customCode=r.customCode,a.customValue=r.customValue,n.push(a),a={}}var l={solarCalendarStr:this.userbirthday,sexCode:this.userSexCode||null,email:this.userEmail,account:this.username,usrCode:this.username,photoId:this.photoId};N["k"].updateUserInfo(l).then(function(t){1===t&&(e.btnLock=!1,Object(s["a"])("修改信息成功~"),e.getUserInfo())})}else Object(s["a"])("昵称不能包含空格~")}else Object(s["a"])("昵称为必填内容~")},getMemberInfo:function(){var e=this,t={busContsCode:baseConstant.busContsCode};N["k"].getMemberInfo(t).then(function(t){e.memberInfo=t})},changeMember:function(e){var t=this;this.memberInfo.forEach(function(i){i.customCode===t.memberType&&(i.customValue=e)}),this.showMemberSelect=!1,this.changeMemberInfo=[]},cancelMemberInfo:function(){this.showMemberSelect=!1,this.changeMemberInfo=[]},showPopup:function(e){var t=this,i={};this.memberType=e.customCode,e.choiceValues.forEach(function(e){i=e.valueName,t.changeMemberInfo.push(i)}),this.showMemberSelect=!0},typeLimit:function(e){"D_INTEGER"===e.fieldType&&(e.customValue=e.customValue.replace(/[^0-9.]+/,""))},typeCheck:function(e){if(e.customValue){if("D_INTEGER"===e.fieldType){var t=/^[0-9]+(.[0-9]{1,3})?$/;return t.test(e.customValue)&&e.customValue?e.maxValue&&Number(e.customValue)>Number(e.maxValue)?(Object(s["a"])(e.customName+"的最大值不能超过"+e.maxValue),void(e.customValue="")):e.minValue&&Number(e.customValue)<Number(e.minValue)?(Object(s["a"])(e.customName+"的最小值为"+e.minValue),void(e.customValue="")):(e.customValue=Number(e.customValue),void(this.scrollTop>0&&window.scroll(0,this.scrollTop))):(Object(s["a"])(e.customName+"只允许输入不超过三位小数的数字~"),e.customValue="",!1)}this.scrollTop>0&&window.scroll(0,this.scrollTop)}}},created:function(){this.getUserInfo()}}),M=E,O=(i("c955"),i("2877")),$=Object(O["a"])(M,a,n,!1,null,"5a50cfd3",null);t["default"]=$.exports},"8f80":function(e,t,i){"use strict";var a=i("1988"),n=i("a142"),s=Object(n["i"])("uploader"),o=s[0],r=s[1];t["a"]=o({inheritAttrs:!1,props:{disabled:Boolean,beforeRead:Function,afterRead:Function,accept:{type:String,default:"image/*"},resultType:{type:String,default:"dataUrl"},maxSize:{type:Number,default:Number.MAX_VALUE}},computed:{detail:function(){return{name:this.$attrs.name||""}}},methods:{onChange:function(e){var t=this,i=e.target.files;!this.disabled&&i.length&&(i=1===i.length?i[0]:[].slice.call(i,0),!i||this.beforeRead&&!this.beforeRead(i,this.detail)?this.resetInput():Array.isArray(i)?Promise.all(i.map(this.readFile)).then(function(e){var a=!1,n=i.map(function(n,s){return n.size>t.maxSize&&(a=!0),{file:i[s],content:e[s]}});t.onAfterRead(n,a)}):this.readFile(i).then(function(e){t.onAfterRead({file:i,content:e},i.size>t.maxSize)}))},readFile:function(e){var t=this;return new Promise(function(i){var a=new FileReader;a.onload=function(e){i(e.target.result)},"dataUrl"===t.resultType?a.readAsDataURL(e):"text"===t.resultType&&a.readAsText(e)})},onAfterRead:function(e,t){t?this.$emit("oversize",e):this.afterRead&&this.afterRead(e,this.detail),this.resetInput()},resetInput:function(){this.$refs.input&&(this.$refs.input.value="")}},render:function(e){var t=this.accept,i=this.disabled;return e("div",{class:r()},[this.slots(),e("input",{attrs:Object(a["a"])({},this.$attrs,{type:"file",accept:t,disabled:i}),ref:"input",class:r("input"),on:{change:this.onChange}})])}})},b819:function(e,t,i){},bcd3:function(e,t,i){},c3a6:function(e,t,i){"use strict";i("68ef")},c955:function(e,t,i){"use strict";var a=i("b819"),n=i.n(a);n.a},dde9:function(e,t,i){},e930:function(e,t,i){"use strict";i("68ef"),i("bcd3")}}]);